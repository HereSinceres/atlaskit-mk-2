ED-7212 Add cleanup to the macroProvider such that it unsubscribes on destroy
